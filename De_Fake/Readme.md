# De-Fake

## Overview

The De-Fake repository provides tools for detecting and attributing fake images generated by text-to-image models. This project is based on the paper [DE-FAKE: Detection and Attribution of Fake Images Generated by Text-to-Image Generation Models](https://arxiv.org/pdf/2210.06998). It leverages a fine-tuned CLIP model and BLIP captioning to evaluate images, compute metrics for each image, and calculate average metrics.

## Quick Start

### 1. Clone the Repository

First, clone the repository to your local machine:

```bash
git clone https://github.com/zeyangsha/De-Fake.git
cd De-Fake
```

### 2. Update Configuration

- **Set Image Folder Path:**

  Open the `run.sh` script and update the paths for your image folders:

  ```bash
  REAL_IMAGE_FOLDER="/path/to/your/real_images"
  FAKE_IMAGE_FOLDER="/path/to/your/fake_images"
  ```

- **Ensure `base_path` in `blipmodels/path_config.py` is Correct:**

  Check that the `base_path` variable in `path_config.py` is set to the path where your BLIP model files are located.

### 3. Run the Setup Script

The `setup.sh` script will create a conda environment and install all necessary packages. Execute the following command:

```bash
bash setup.sh
```

### 4. Process Images

Once the setup is complete, run the `run.sh` script to process images and calculate metrics:

```bash
bash run.sh
```

This script will:
- Process images from the specified folders.
- Save metrics for each image.
- Calculate and save average metrics.

## Requirements

- **Conda:** Ensure you have `conda` installed. If not, [install conda](https://docs.conda.io/en/latest/miniconda.html).
- **gdown:** Install `gdown` for downloading files from Google Drive.

## Notes

- Place the `test.py` and `average_metrics.py` scripts in the repository directory before running `run.sh`.
- Ensure that all necessary files and models are correctly referenced and available as specified in the scripts and configuration files.

## Troubleshooting

- If you encounter issues with `conda` or package installations, make sure you have a compatible Python version and network access.
- For any issues related to model paths or file downloads, verify the paths and URLs in your configuration files.

## Contributing

Feel free to contribute to this project by submitting issues, feature requests, or pull requests.